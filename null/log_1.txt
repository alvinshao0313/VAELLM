2026-01-29 01:59:40 Loading LLM from meta-llama/Llama-2-7b-hf...
2026-01-29 01:59:42 ---> Loading meta-llama/Llama-2-7b-hf Model with seq_len: 2048
2026-01-29 01:59:42 === Group: down_proj | Layers: L0.mlp.down_proj ... L0.mlp.down_proj (1) ===
2026-01-29 01:59:46 [down_proj] Step 100: Loss=0.05056 | recon_loss=0.21710 | commitment_loss=-0.01468 | all_commitment_loss=2.15560 | g_loss=-0.50620 | d_loss=0.96983 | logits_real=0.57433 | logits_fake=0.50620 | Speed: 0.0365s/it
2026-01-29 01:59:48 [down_proj] Step 200: Loss=0.12113 | recon_loss=0.20144 | commitment_loss=-0.01120 | all_commitment_loss=3.65064 | g_loss=-0.23036 | d_loss=0.94824 | logits_real=0.34428 | logits_fake=0.23036 | Speed: 0.0272s/it
2026-01-29 01:59:51 [down_proj] Step 300: Loss=0.24372 | recon_loss=0.19803 | commitment_loss=-0.01079 | all_commitment_loss=6.59804 | g_loss=0.18829 | d_loss=0.91358 | logits_real=0.01827 | logits_fake=-0.18829 | Speed: 0.0270s/it
2026-01-29 01:59:54 [down_proj] Step 400: Loss=0.24263 | recon_loss=0.19524 | commitment_loss=-0.01002 | all_commitment_loss=9.68192 | g_loss=0.19137 | d_loss=0.91887 | logits_real=0.02922 | logits_fake=-0.19137 | Speed: 0.0270s/it
2026-01-29 01:59:57 [down_proj] Step 500: Loss=0.25983 | recon_loss=0.18803 | commitment_loss=-0.00969 | all_commitment_loss=12.73708 | g_loss=0.27164 | d_loss=0.90215 | logits_real=-0.01687 | logits_fake=-0.27164 | Speed: 0.0271s/it
2026-01-29 01:59:59 [down_proj] Step 600: Loss=0.27358 | recon_loss=0.18982 | commitment_loss=-0.01005 | all_commitment_loss=16.52471 | g_loss=0.31271 | d_loss=0.88871 | logits_real=-0.03000 | logits_fake=-0.31271 | Speed: 0.0269s/it
2026-01-29 02:00:02 [down_proj] Step 700: Loss=0.29603 | recon_loss=0.18670 | commitment_loss=-0.01046 | all_commitment_loss=18.86926 | g_loss=0.39932 | d_loss=0.88367 | logits_real=-0.09948 | logits_fake=-0.39932 | Speed: 0.0276s/it
2026-01-29 02:00:05 [down_proj] Step 800: Loss=0.28280 | recon_loss=0.18181 | commitment_loss=-0.01166 | all_commitment_loss=20.47780 | g_loss=0.37548 | d_loss=0.91093 | logits_real=-0.12444 | logits_fake=-0.37548 | Speed: 0.0257s/it
2026-01-29 02:00:07 [down_proj] Step 900: Loss=0.29147 | recon_loss=0.17743 | commitment_loss=-0.01190 | all_commitment_loss=21.22301 | g_loss=0.41983 | d_loss=0.89089 | logits_real=-0.13644 | logits_fake=-0.41983 | Speed: 0.0285s/it
2026-01-29 02:00:10 [down_proj] Step 1000: Loss=0.30454 | recon_loss=0.18170 | commitment_loss=-0.01188 | all_commitment_loss=21.32928 | g_loss=0.44907 | d_loss=0.88894 | logits_real=-0.14359 | logits_fake=-0.44907 | Speed: 0.0256s/it
2026-01-29 02:00:13 [down_proj] Step 1100: Loss=0.29533 | recon_loss=0.17061 | commitment_loss=-0.01245 | all_commitment_loss=24.04171 | g_loss=0.45725 | d_loss=0.89526 | logits_real=-0.17607 | logits_fake=-0.45725 | Speed: 0.0269s/it
2026-01-29 02:00:15 [down_proj] Step 1200: Loss=0.30140 | recon_loss=0.16591 | commitment_loss=-0.01269 | all_commitment_loss=23.79903 | g_loss=0.49392 | d_loss=0.89181 | logits_real=-0.20178 | logits_fake=-0.49392 | Speed: 0.0268s/it
2026-01-29 02:00:18 [down_proj] Step 1300: Loss=0.30375 | recon_loss=0.16649 | commitment_loss=-0.01254 | all_commitment_loss=24.90547 | g_loss=0.49934 | d_loss=0.89766 | logits_real=-0.22481 | logits_fake=-0.49934 | Speed: 0.0269s/it
2026-01-29 02:00:21 [down_proj] Step 1400: Loss=0.30623 | recon_loss=0.16702 | commitment_loss=-0.01203 | all_commitment_loss=25.83220 | g_loss=0.50416 | d_loss=0.90914 | logits_real=-0.24695 | logits_fake=-0.50416 | Speed: 0.0251s/it
2026-01-29 02:00:23 [down_proj] Step 1500: Loss=0.33405 | recon_loss=0.17367 | commitment_loss=-0.01145 | all_commitment_loss=25.36278 | g_loss=0.57277 | d_loss=0.87371 | logits_real=-0.22595 | logits_fake=-0.57277 | Speed: 0.0270s/it
2026-01-29 02:00:26 [down_proj] Step 1600: Loss=0.32630 | recon_loss=0.16758 | commitment_loss=-0.01138 | all_commitment_loss=25.97560 | g_loss=0.56702 | d_loss=0.88391 | logits_real=-0.25880 | logits_fake=-0.56702 | Speed: 0.0270s/it
2026-01-29 02:00:29 [down_proj] Step 1700: Loss=0.34437 | recon_loss=0.16525 | commitment_loss=-0.01076 | all_commitment_loss=27.06346 | g_loss=0.63292 | d_loss=0.88408 | logits_real=-0.32479 | logits_fake=-0.63292 | Speed: 0.0272s/it
2026-01-29 02:00:31 [down_proj] Step 1800: Loss=0.33813 | recon_loss=0.17151 | commitment_loss=-0.01101 | all_commitment_loss=29.78633 | g_loss=0.59211 | d_loss=0.89313 | logits_real=-0.29330 | logits_fake=-0.59211 | Speed: 0.0270s/it
2026-01-29 02:00:34 [down_proj] Step 1900: Loss=0.33846 | recon_loss=0.16933 | commitment_loss=-0.01055 | all_commitment_loss=28.11924 | g_loss=0.59894 | d_loss=0.90521 | logits_real=-0.31933 | logits_fake=-0.59894 | Speed: 0.0274s/it
2026-01-29 02:00:37 [down_proj] Step 2000: Loss=0.33515 | recon_loss=0.16735 | commitment_loss=-0.01043 | all_commitment_loss=29.10390 | g_loss=0.59409 | d_loss=0.88559 | logits_real=-0.26383 | logits_fake=-0.59409 | Speed: 0.0273s/it
2026-01-29 02:00:39 [down_proj] Step 2100: Loss=0.35023 | recon_loss=0.18570 | commitment_loss=-0.00991 | all_commitment_loss=32.23639 | g_loss=0.58148 | d_loss=0.90231 | logits_real=-0.26218 | logits_fake=-0.58148 | Speed: 0.0257s/it
2026-01-29 02:00:42 [down_proj] Step 2200: Loss=0.34126 | recon_loss=0.15900 | commitment_loss=-0.01091 | all_commitment_loss=34.52474 | g_loss=0.64388 | d_loss=0.88603 | logits_real=-0.31688 | logits_fake=-0.64388 | Speed: 0.0289s/it
2026-01-29 02:00:45 [down_proj] Step 2300: Loss=0.34631 | recon_loss=0.15448 | commitment_loss=-0.01013 | all_commitment_loss=35.07910 | g_loss=0.67319 | d_loss=0.90013 | logits_real=-0.39384 | logits_fake=-0.67319 | Speed: 0.0255s/it
2026-01-29 02:00:48 [down_proj] Step 2400: Loss=0.34948 | recon_loss=0.16005 | commitment_loss=-0.00931 | all_commitment_loss=34.47361 | g_loss=0.66248 | d_loss=0.90426 | logits_real=-0.37169 | logits_fake=-0.66248 | Speed: 0.0270s/it
2026-01-29 02:00:50 [down_proj] Step 2500: Loss=0.35238 | recon_loss=0.15871 | commitment_loss=-0.00931 | all_commitment_loss=36.01000 | g_loss=0.67659 | d_loss=0.89232 | logits_real=-0.35112 | logits_fake=-0.67659 | Speed: 0.0277s/it
2026-01-29 02:00:53 [down_proj] Step 2600: Loss=0.36058 | recon_loss=0.15604 | commitment_loss=-0.00916 | all_commitment_loss=35.39114 | g_loss=0.71236 | d_loss=0.88857 | logits_real=-0.39167 | logits_fake=-0.71236 | Speed: 0.0279s/it
2026-01-29 02:00:56 [down_proj] Step 2700: Loss=0.34146 | recon_loss=0.14884 | commitment_loss=-0.00932 | all_commitment_loss=34.30579 | g_loss=0.67313 | d_loss=0.90930 | logits_real=-0.39658 | logits_fake=-0.67313 | Speed: 0.0279s/it
2026-01-29 02:00:59 [down_proj] Step 2800: Loss=0.33530 | recon_loss=0.14484 | commitment_loss=-0.00996 | all_commitment_loss=30.66507 | g_loss=0.66805 | d_loss=0.91911 | logits_real=-0.39625 | logits_fake=-0.66805 | Speed: 0.0344s/it
2026-01-29 02:01:02 [down_proj] Step 2900: Loss=0.35932 | recon_loss=0.15417 | commitment_loss=-0.00869 | all_commitment_loss=31.53073 | g_loss=0.71278 | d_loss=0.88588 | logits_real=-0.37091 | logits_fake=-0.71278 | Speed: 0.0255s/it
2026-01-29 02:01:05 [down_proj] Step 3000: Loss=0.35029 | recon_loss=0.15348 | commitment_loss=-0.00998 | all_commitment_loss=33.65984 | g_loss=0.68930 | d_loss=0.88887 | logits_real=-0.35654 | logits_fake=-0.68930 | Speed: 0.0272s/it
2026-01-29 02:01:07 [down_proj] Step 3100: Loss=0.33824 | recon_loss=0.14755 | commitment_loss=-0.00974 | all_commitment_loss=33.27409 | g_loss=0.66811 | d_loss=0.89387 | logits_real=-0.34608 | logits_fake=-0.66811 | Speed: 0.0284s/it
2026-01-29 02:01:10 [down_proj] Step 3200: Loss=0.34215 | recon_loss=0.15042 | commitment_loss=-0.00950 | all_commitment_loss=31.21782 | g_loss=0.67074 | d_loss=0.89998 | logits_real=-0.34027 | logits_fake=-0.67074 | Speed: 0.0271s/it
2026-01-29 02:01:13 [down_proj] Step 3300: Loss=0.34498 | recon_loss=0.14814 | commitment_loss=-0.01000 | all_commitment_loss=29.39194 | g_loss=0.68946 | d_loss=0.90239 | logits_real=-0.38094 | logits_fake=-0.68946 | Speed: 0.0272s/it
2026-01-29 02:01:16 [down_proj] Step 3400: Loss=0.35771 | recon_loss=0.14726 | commitment_loss=-0.00991 | all_commitment_loss=28.06365 | g_loss=0.73453 | d_loss=0.89651 | logits_real=-0.42763 | logits_fake=-0.73453 | Speed: 0.0271s/it
2026-01-29 02:01:18 [down_proj] Step 3500: Loss=0.35458 | recon_loss=0.15224 | commitment_loss=-0.00960 | all_commitment_loss=26.53314 | g_loss=0.70644 | d_loss=0.89397 | logits_real=-0.38842 | logits_fake=-0.70644 | Speed: 0.0270s/it
2026-01-29 02:01:21 [down_proj] Step 3600: Loss=0.33673 | recon_loss=0.15168 | commitment_loss=-0.00963 | all_commitment_loss=24.88047 | g_loss=0.64893 | d_loss=0.89996 | logits_real=-0.31469 | logits_fake=-0.64893 | Speed: 0.0252s/it
2026-01-29 02:01:24 [down_proj] Step 3700: Loss=0.36032 | recon_loss=0.14944 | commitment_loss=-0.00919 | all_commitment_loss=22.88424 | g_loss=0.73355 | d_loss=0.89529 | logits_real=-0.42415 | logits_fake=-0.73355 | Speed: 0.0288s/it
2026-01-29 02:01:26 [down_proj] Step 3800: Loss=0.34310 | recon_loss=0.14419 | commitment_loss=-0.00944 | all_commitment_loss=22.38230 | g_loss=0.69451 | d_loss=0.89909 | logits_real=-0.38691 | logits_fake=-0.69451 | Speed: 0.0253s/it
2026-01-29 02:01:29 [down_proj] Step 3900: Loss=0.34799 | recon_loss=0.14764 | commitment_loss=-0.00922 | all_commitment_loss=21.37066 | g_loss=0.69853 | d_loss=0.90526 | logits_real=-0.38870 | logits_fake=-0.69853 | Speed: 0.0268s/it
2026-01-29 02:01:32 [down_proj] Step 4000: Loss=0.35099 | recon_loss=0.14681 | commitment_loss=-0.00905 | all_commitment_loss=21.01814 | g_loss=0.71077 | d_loss=0.89490 | logits_real=-0.38294 | logits_fake=-0.71077 | Speed: 0.0270s/it
2026-01-29 02:01:34 [down_proj] Step 4100: Loss=0.34921 | recon_loss=0.14113 | commitment_loss=-0.00933 | all_commitment_loss=19.82130 | g_loss=0.72469 | d_loss=0.90114 | logits_real=-0.41830 | logits_fake=-0.72469 | Speed: 0.0269s/it
2026-01-29 02:01:37 [down_proj] Step 4200: Loss=0.35110 | recon_loss=0.14563 | commitment_loss=-0.00925 | all_commitment_loss=19.35732 | g_loss=0.71574 | d_loss=0.89812 | logits_real=-0.38743 | logits_fake=-0.71574 | Speed: 0.0274s/it
2026-01-29 02:01:40 [down_proj] Step 4300: Loss=0.34925 | recon_loss=0.14020 | commitment_loss=-0.00937 | all_commitment_loss=18.78336 | g_loss=0.72805 | d_loss=0.90089 | logits_real=-0.42952 | logits_fake=-0.72805 | Speed: 0.0273s/it
2026-01-29 02:01:42 [down_proj] Step 4400: Loss=0.36059 | recon_loss=0.15072 | commitment_loss=-0.00915 | all_commitment_loss=18.72561 | g_loss=0.73006 | d_loss=0.89407 | logits_real=-0.39099 | logits_fake=-0.73006 | Speed: 0.0254s/it
2026-01-29 02:01:45 [down_proj] Step 4500: Loss=0.35249 | recon_loss=0.14776 | commitment_loss=-0.00927 | all_commitment_loss=18.23592 | g_loss=0.71332 | d_loss=0.89734 | logits_real=-0.37968 | logits_fake=-0.71332 | Speed: 0.0272s/it
2026-01-29 02:01:48 [down_proj] Step 4600: Loss=0.35506 | recon_loss=0.14493 | commitment_loss=-0.00913 | all_commitment_loss=17.99773 | g_loss=0.73087 | d_loss=0.89012 | logits_real=-0.39963 | logits_fake=-0.73087 | Speed: 0.0273s/it
2026-01-29 02:01:50 [down_proj] Step 4700: Loss=0.37940 | recon_loss=0.16865 | commitment_loss=-0.00933 | all_commitment_loss=17.95497 | g_loss=0.73360 | d_loss=0.88231 | logits_real=-0.35712 | logits_fake=-0.73360 | Speed: 0.0269s/it
2026-01-29 02:01:53 [down_proj] Step 4800: Loss=0.35302 | recon_loss=0.14113 | commitment_loss=-0.00906 | all_commitment_loss=18.02615 | g_loss=0.73652 | d_loss=0.88888 | logits_real=-0.41234 | logits_fake=-0.73652 | Speed: 0.0278s/it
2026-01-29 02:01:56 [down_proj] Step 4900: Loss=0.35412 | recon_loss=0.14012 | commitment_loss=-0.00925 | all_commitment_loss=17.66674 | g_loss=0.74417 | d_loss=0.89911 | logits_real=-0.44071 | logits_fake=-0.74417 | Speed: 0.0270s/it
2026-01-29 02:01:59 [down_proj] Step 5000: Loss=0.36564 | recon_loss=0.15484 | commitment_loss=-0.00938 | all_commitment_loss=17.80189 | g_loss=0.73391 | d_loss=0.88612 | logits_real=-0.35276 | logits_fake=-0.73391 | Speed: 0.0270s/it
2026-01-29 02:01:59 Reconstructing down_proj...
2026-01-29 02:01:59 DEBUG: First Batch Recon L1 Diff: 0.2968687415122986
2026-01-29 02:02:29 DEBUG: Layer 0 first element: 0.0027008056640625 -> 0.0030689239501953125
2026-01-29 02:02:29 Replaced 1 layers for down_proj.
2026-01-29 02:02:29 Note: detected 256 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
2026-01-29 02:02:29 Note: NumExpr detected 256 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
2026-01-29 02:02:29 NumExpr defaulting to 16 threads.
2026-01-29 02:02:29 PyTorch version 2.6.0+cu124 available.
2026-01-29 02:02:32 Evaluating Wikitext-2 PPL...
2026-01-29 02:02:32 Loading local wikitext parquet from /home/shaoyuantian/.cache/huggingface/hub/datasets--wikitext/snapshots/b08601e04326c79dfdd32d625aee71d232d685c3/wikitext-2-raw-v1/test-00000-of-00001.parquet
2026-01-29 02:03:59 wikitext ppl : 5.52
2026-01-29 02:04:03 After reconstruction PPL evaluated: {'wiki_ppl': 5.519840717315674}
2026-01-29 02:04:03 === Group: down_proj | Layers: L1.mlp.down_proj ... L1.mlp.down_proj (1) ===
2026-01-29 02:04:06 [down_proj] Step 100: Loss=0.02243 | recon_loss=0.20269 | commitment_loss=-0.01341 | all_commitment_loss=1.90888 | g_loss=-0.55618 | d_loss=0.96193 | logits_real=0.63835 | logits_fake=0.55618 | Speed: 0.0269s/it
2026-01-29 02:04:08 [down_proj] Step 200: Loss=0.10734 | recon_loss=0.20266 | commitment_loss=-0.01104 | all_commitment_loss=5.06056 | g_loss=-0.28095 | d_loss=0.94605 | logits_real=0.40129 | logits_fake=0.28095 | Speed: 0.0239s/it
2026-01-29 02:04:11 [down_proj] Step 300: Loss=0.24110 | recon_loss=0.19645 | commitment_loss=-0.01031 | all_commitment_loss=8.55417 | g_loss=0.18318 | d_loss=0.90900 | logits_real=0.02224 | logits_fake=-0.18318 | Speed: 0.0284s/it
2026-01-29 02:04:14 [down_proj] Step 400: Loss=0.26804 | recon_loss=0.20048 | commitment_loss=-0.01039 | all_commitment_loss=10.61172 | g_loss=0.25983 | d_loss=0.91172 | logits_real=-0.01330 | logits_fake=-0.25983 | Speed: 0.0282s/it
2026-01-29 02:04:17 [down_proj] Step 500: Loss=0.24743 | recon_loss=0.17413 | commitment_loss=-0.01152 | all_commitment_loss=12.34587 | g_loss=0.28275 | d_loss=0.91144 | logits_real=-0.05114 | logits_fake=-0.28275 | Speed: 0.0263s/it
2026-01-29 02:04:19 [down_proj] Step 600: Loss=0.27200 | recon_loss=0.19140 | commitment_loss=-0.01075 | all_commitment_loss=15.88861 | g_loss=0.30449 | d_loss=0.90622 | logits_real=-0.04957 | logits_fake=-0.30449 | Speed: 0.0262s/it
2026-01-29 02:04:22 [down_proj] Step 700: Loss=0.25928 | recon_loss=0.17564 | commitment_loss=-0.01150 | all_commitment_loss=18.34474 | g_loss=0.31715 | d_loss=0.90826 | logits_real=-0.07226 | logits_fake=-0.31715 | Speed: 0.0300s/it
2026-01-29 02:04:25 [down_proj] Step 800: Loss=0.27339 | recon_loss=0.18640 | commitment_loss=-0.01179 | all_commitment_loss=24.62991 | g_loss=0.32924 | d_loss=0.88808 | logits_real=-0.03428 | logits_fake=-0.32924 | Speed: 0.0279s/it
2026-01-29 02:04:28 [down_proj] Step 900: Loss=0.28370 | recon_loss=0.17628 | commitment_loss=-0.01133 | all_commitment_loss=27.27749 | g_loss=0.39584 | d_loss=0.90542 | logits_real=-0.14217 | logits_fake=-0.39584 | Speed: 0.0306s/it
2026-01-29 02:04:31 [down_proj] Step 1000: Loss=0.27578 | recon_loss=0.16905 | commitment_loss=-0.01373 | all_commitment_loss=27.37182 | g_loss=0.40151 | d_loss=0.89240 | logits_real=-0.11416 | logits_fake=-0.40151 | Speed: 0.0275s/it
2026-01-29 02:04:34 [down_proj] Step 1100: Loss=0.28349 | recon_loss=0.17222 | commitment_loss=-0.01282 | all_commitment_loss=30.18609 | g_loss=0.41365 | d_loss=0.89191 | logits_real=-0.12182 | logits_fake=-0.41365 | Speed: 0.0304s/it
2026-01-29 02:04:37 [down_proj] Step 1200: Loss=0.28774 | recon_loss=0.16809 | commitment_loss=-0.01340 | all_commitment_loss=34.55507 | g_loss=0.44353 | d_loss=0.91072 | logits_real=-0.19455 | logits_fake=-0.44353 | Speed: 0.0309s/it
2026-01-29 02:04:40 [down_proj] Step 1300: Loss=0.28999 | recon_loss=0.16435 | commitment_loss=-0.01350 | all_commitment_loss=35.79604 | g_loss=0.46381 | d_loss=0.90331 | logits_real=-0.19988 | logits_fake=-0.46381 | Speed: 0.0274s/it
2026-01-29 02:04:43 [down_proj] Step 1400: Loss=0.31831 | recon_loss=0.17924 | commitment_loss=-0.01362 | all_commitment_loss=39.27002 | g_loss=0.50897 | d_loss=0.89000 | logits_real=-0.18580 | logits_fake=-0.50897 | Speed: 0.0308s/it
2026-01-29 02:04:45 [down_proj] Step 1500: Loss=0.31088 | recon_loss=0.17170 | commitment_loss=-0.01305 | all_commitment_loss=44.02049 | g_loss=0.50744 | d_loss=0.89662 | logits_real=-0.21178 | logits_fake=-0.50744 | Speed: 0.0273s/it
2026-01-29 02:04:48 [down_proj] Step 1600: Loss=0.32534 | recon_loss=0.17130 | commitment_loss=-0.01288 | all_commitment_loss=45.39559 | g_loss=0.55642 | d_loss=0.88460 | logits_real=-0.24478 | logits_fake=-0.55642 | Speed: 0.0301s/it
2026-01-29 02:04:51 [down_proj] Step 1700: Loss=0.31578 | recon_loss=0.17054 | commitment_loss=-0.01320 | all_commitment_loss=49.91438 | g_loss=0.52817 | d_loss=0.90196 | logits_real=-0.25057 | logits_fake=-0.52817 | Speed: 0.0300s/it
2026-01-29 02:04:54 [down_proj] Step 1800: Loss=0.32433 | recon_loss=0.16468 | commitment_loss=-0.01288 | all_commitment_loss=48.98069 | g_loss=0.57512 | d_loss=0.89503 | logits_real=-0.29614 | logits_fake=-0.57512 | Speed: 0.0261s/it
2026-01-29 02:04:57 [down_proj] Step 1900: Loss=0.33382 | recon_loss=0.16963 | commitment_loss=-0.01252 | all_commitment_loss=45.17276 | g_loss=0.58904 | d_loss=0.87956 | logits_real=-0.25601 | logits_fake=-0.58904 | Speed: 0.0295s/it
2026-01-29 02:05:00 [down_proj] Step 2000: Loss=0.34423 | recon_loss=0.16546 | commitment_loss=-0.01208 | all_commitment_loss=40.46635 | g_loss=0.63616 | d_loss=0.88150 | logits_real=-0.31367 | logits_fake=-0.63616 | Speed: 0.0268s/it
2026-01-29 02:05:03 [down_proj] Step 2100: Loss=0.35028 | recon_loss=0.16947 | commitment_loss=-0.01168 | all_commitment_loss=39.88223 | g_loss=0.64162 | d_loss=0.87504 | logits_real=-0.27879 | logits_fake=-0.64162 | Speed: 0.0294s/it
2026-01-29 02:05:06 [down_proj] Step 2200: Loss=0.35696 | recon_loss=0.17636 | commitment_loss=-0.01064 | all_commitment_loss=41.22488 | g_loss=0.63745 | d_loss=0.88141 | logits_real=-0.27463 | logits_fake=-0.63745 | Speed: 0.0292s/it
2026-01-29 02:05:08 [down_proj] Step 2300: Loss=0.34845 | recon_loss=0.16680 | commitment_loss=-0.01076 | all_commitment_loss=39.71487 | g_loss=0.64134 | d_loss=0.89794 | logits_real=-0.31859 | logits_fake=-0.64134 | Speed: 0.0267s/it
2026-01-29 02:05:11 [down_proj] Step 2400: Loss=0.33709 | recon_loss=0.16019 | commitment_loss=-0.01118 | all_commitment_loss=37.82025 | g_loss=0.62696 | d_loss=0.90032 | logits_real=-0.32335 | logits_fake=-0.62696 | Speed: 0.0273s/it
2026-01-29 02:05:14 [down_proj] Step 2500: Loss=0.37365 | recon_loss=0.16648 | commitment_loss=-0.01090 | all_commitment_loss=37.73601 | g_loss=0.72691 | d_loss=0.85919 | logits_real=-0.31599 | logits_fake=-0.72691 | Speed: 0.0292s/it
2026-01-29 02:05:17 [down_proj] Step 2600: Loss=0.34945 | recon_loss=0.16321 | commitment_loss=-0.01066 | all_commitment_loss=36.53795 | g_loss=0.65633 | d_loss=0.89597 | logits_real=-0.32375 | logits_fake=-0.65633 | Speed: 0.0268s/it
2026-01-29 02:05:19 [down_proj] Step 2700: Loss=0.36183 | recon_loss=0.16426 | commitment_loss=-0.01063 | all_commitment_loss=34.64872 | g_loss=0.69398 | d_loss=0.87936 | logits_real=-0.31454 | logits_fake=-0.69398 | Speed: 0.0291s/it
2026-01-29 02:05:23 [down_proj] Step 2800: Loss=0.37707 | recon_loss=0.16226 | commitment_loss=-0.01015 | all_commitment_loss=33.05702 | g_loss=0.74989 | d_loss=0.86898 | logits_real=-0.36540 | logits_fake=-0.74989 | Speed: 0.0324s/it
2026-01-29 02:05:26 [down_proj] Step 2900: Loss=0.36478 | recon_loss=0.16439 | commitment_loss=-0.00988 | all_commitment_loss=31.28150 | g_loss=0.70092 | d_loss=0.87807 | logits_real=-0.32308 | logits_fake=-0.70092 | Speed: 0.0292s/it
2026-01-29 02:05:29 [down_proj] Step 3000: Loss=0.36483 | recon_loss=0.16597 | commitment_loss=-0.00983 | all_commitment_loss=28.69862 | g_loss=0.69565 | d_loss=0.89056 | logits_real=-0.34482 | logits_fake=-0.69565 | Speed: 0.0292s/it
2026-01-29 02:05:31 [down_proj] Step 3100: Loss=0.36896 | recon_loss=0.16212 | commitment_loss=-0.01008 | all_commitment_loss=27.77012 | g_loss=0.72307 | d_loss=0.87643 | logits_real=-0.34526 | logits_fake=-0.72307 | Speed: 0.0267s/it
2026-01-29 02:05:34 [down_proj] Step 3200: Loss=0.35569 | recon_loss=0.16267 | commitment_loss=-0.00982 | all_commitment_loss=26.84743 | g_loss=0.67613 | d_loss=0.87448 | logits_real=-0.28931 | logits_fake=-0.67613 | Speed: 0.0290s/it
2026-01-29 02:05:37 [down_proj] Step 3300: Loss=0.35860 | recon_loss=0.16339 | commitment_loss=-0.00918 | all_commitment_loss=26.01507 | g_loss=0.68130 | d_loss=0.89624 | logits_real=-0.32718 | logits_fake=-0.68130 | Speed: 0.0267s/it
2026-01-29 02:05:40 [down_proj] Step 3400: Loss=0.37596 | recon_loss=0.16643 | commitment_loss=-0.00867 | all_commitment_loss=24.75142 | g_loss=0.72734 | d_loss=0.87240 | logits_real=-0.33144 | logits_fake=-0.72734 | Speed: 0.0289s/it
2026-01-29 02:05:43 [down_proj] Step 3500: Loss=0.36480 | recon_loss=0.16559 | commitment_loss=-0.00946 | all_commitment_loss=23.46382 | g_loss=0.69557 | d_loss=0.88077 | logits_real=-0.30710 | logits_fake=-0.69557 | Speed: 0.0284s/it
2026-01-29 02:05:45 [down_proj] Step 3600: Loss=0.36650 | recon_loss=0.16295 | commitment_loss=-0.00866 | all_commitment_loss=23.58050 | g_loss=0.70736 | d_loss=0.88169 | logits_real=-0.32849 | logits_fake=-0.70736 | Speed: 0.0255s/it
2026-01-29 02:05:47 [down_proj] Step 3700: Loss=0.35676 | recon_loss=0.16286 | commitment_loss=-0.00883 | all_commitment_loss=22.85059 | g_loss=0.67580 | d_loss=0.88612 | logits_real=-0.27802 | logits_fake=-0.67580 | Speed: 0.0193s/it
2026-01-29 02:05:50 [down_proj] Step 3800: Loss=0.36615 | recon_loss=0.15945 | commitment_loss=-0.00909 | all_commitment_loss=21.83549 | g_loss=0.71931 | d_loss=0.86944 | logits_real=-0.33724 | logits_fake=-0.71931 | Speed: 0.0264s/it
2026-01-29 02:05:52 [down_proj] Step 3900: Loss=0.35653 | recon_loss=0.16053 | commitment_loss=-0.00943 | all_commitment_loss=20.86538 | g_loss=0.68476 | d_loss=0.88457 | logits_real=-0.31481 | logits_fake=-0.68476 | Speed: 0.0276s/it
2026-01-29 02:05:54 [down_proj] Step 4000: Loss=0.35100 | recon_loss=0.15736 | commitment_loss=-0.00944 | all_commitment_loss=19.92326 | g_loss=0.67695 | d_loss=0.89020 | logits_real=-0.32629 | logits_fake=-0.67695 | Speed: 0.0204s/it
2026-01-29 02:05:56 [down_proj] Step 4100: Loss=0.35374 | recon_loss=0.15592 | commitment_loss=-0.00940 | all_commitment_loss=18.74075 | g_loss=0.69077 | d_loss=0.89676 | logits_real=-0.35305 | logits_fake=-0.69077 | Speed: 0.0173s/it
2026-01-29 02:05:58 [down_proj] Step 4200: Loss=0.36014 | recon_loss=0.15648 | commitment_loss=-0.00954 | all_commitment_loss=18.56069 | g_loss=0.71065 | d_loss=0.87691 | logits_real=-0.32742 | logits_fake=-0.71065 | Speed: 0.0170s/it
2026-01-29 02:06:00 [down_proj] Step 4300: Loss=0.35713 | recon_loss=0.15623 | commitment_loss=-0.00943 | all_commitment_loss=17.67012 | g_loss=0.70111 | d_loss=0.87107 | logits_real=-0.32023 | logits_fake=-0.70111 | Speed: 0.0188s/it
2026-01-29 02:06:02 [down_proj] Step 4400: Loss=0.36296 | recon_loss=0.15414 | commitment_loss=-0.00943 | all_commitment_loss=17.65751 | g_loss=0.72749 | d_loss=0.88196 | logits_real=-0.37037 | logits_fake=-0.72749 | Speed: 0.0208s/it
2026-01-29 02:06:05 [down_proj] Step 4500: Loss=0.36336 | recon_loss=0.15477 | commitment_loss=-0.00949 | all_commitment_loss=17.47464 | g_loss=0.72694 | d_loss=0.87932 | logits_real=-0.35402 | logits_fake=-0.72694 | Speed: 0.0264s/it
2026-01-29 02:06:07 [down_proj] Step 4600: Loss=0.35991 | recon_loss=0.15202 | commitment_loss=-0.00928 | all_commitment_loss=17.20737 | g_loss=0.72394 | d_loss=0.88213 | logits_real=-0.37108 | logits_fake=-0.72394 | Speed: 0.0216s/it
2026-01-29 02:06:10 [down_proj] Step 4700: Loss=0.35940 | recon_loss=0.15424 | commitment_loss=-0.00982 | all_commitment_loss=16.93038 | g_loss=0.71662 | d_loss=0.88512 | logits_real=-0.34982 | logits_fake=-0.71662 | Speed: 0.0283s/it
2026-01-29 02:06:12 [down_proj] Step 4800: Loss=0.36668 | recon_loss=0.15257 | commitment_loss=-0.00962 | all_commitment_loss=16.61064 | g_loss=0.74578 | d_loss=0.87915 | logits_real=-0.38029 | logits_fake=-0.74578 | Speed: 0.0281s/it
2026-01-29 02:06:15 [down_proj] Step 4900: Loss=0.36850 | recon_loss=0.15402 | commitment_loss=-0.00946 | all_commitment_loss=16.79052 | g_loss=0.74647 | d_loss=0.87266 | logits_real=-0.35554 | logits_fake=-0.74647 | Speed: 0.0263s/it
2026-01-29 02:06:18 [down_proj] Step 5000: Loss=0.36843 | recon_loss=0.15520 | commitment_loss=-0.00920 | all_commitment_loss=16.89972 | g_loss=0.74139 | d_loss=0.87544 | logits_real=-0.36039 | logits_fake=-0.74139 | Speed: 0.0283s/it
2026-01-29 02:06:18 Reconstructing down_proj...
2026-01-29 02:06:18 DEBUG: First Batch Recon L1 Diff: 0.3073161542415619
2026-01-29 02:06:48 DEBUG: Layer 0 first element: 0.0079345703125 -> 0.0065155029296875
2026-01-29 02:06:48 Replaced 1 layers for down_proj.
2026-01-29 02:06:51 Evaluating Wikitext-2 PPL...
2026-01-29 02:06:51 Loading local wikitext parquet from /home/shaoyuantian/.cache/huggingface/hub/datasets--wikitext/snapshots/b08601e04326c79dfdd32d625aee71d232d685c3/wikitext-2-raw-v1/test-00000-of-00001.parquet
